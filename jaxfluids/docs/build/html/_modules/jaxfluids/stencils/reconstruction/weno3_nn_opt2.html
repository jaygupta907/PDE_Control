<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>jaxfluids.stencils.reconstruction.weno3_nn_opt2 &mdash; jaxfluids 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=01f34227"></script>
        <script src="../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            jaxfluids
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">JAX-Fluids: First steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../runsimulation.html">Run Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Under the hood</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../available_modules.html">Available modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../change_log.html">Change log</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">JAX-Fluids API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../jaxfluids.html">jaxfluids package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contact</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../authors.html">Authors</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">jaxfluids</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">jaxfluids.stencils.reconstruction.weno3_nn_opt2</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for jaxfluids.stencils.reconstruction.weno3_nn_opt2</h1><div class="highlight"><pre>
<span></span><span class="c1">#*------------------------------------------------------------------------------*</span>
<span class="c1">#* JAX-FLUIDS -                                                                 *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#* A fully-differentiable CFD solver for compressible two-phase flows.          *</span>
<span class="c1">#* Copyright (C) 2022  Deniz A. Bezgin, Aaron B. Buhendwa, Nikolaus A. Adams    *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#* This program is free software: you can redistribute it and/or modify         *</span>
<span class="c1">#* it under the terms of the GNU General Public License as published by         *</span>
<span class="c1">#* the Free Software Foundation, either version 3 of the License, or            *</span>
<span class="c1">#* (at your option) any later version.                                          *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#* This program is distributed in the hope that it will be useful,              *</span>
<span class="c1">#* but WITHOUT ANY WARRANTY; without even the implied warranty of               *</span>
<span class="c1">#* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                *</span>
<span class="c1">#* GNU General Public License for more details.                                 *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#* You should have received a copy of the GNU General Public License            *</span>
<span class="c1">#* along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.       *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#*------------------------------------------------------------------------------*</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#* CONTACT                                                                      *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#* deniz.bezgin@tum.de // aaron.buhendwa@tum.de // nikolaus.adams@tum.de        *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#*------------------------------------------------------------------------------*</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#* Munich, April 15th, 2022                                                     *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#*------------------------------------------------------------------------------*</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">import</span> <span class="nn">haiku</span> <span class="k">as</span> <span class="nn">hk</span>
<span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>

<span class="kn">from</span> <span class="nn">jaxfluids.stencils.spatial_reconstruction</span> <span class="kn">import</span> <span class="n">SpatialReconstruction</span>

<div class="viewcode-block" id="WENO3NNOPT2">
<a class="viewcode-back" href="../../../../jaxfluids.stencils.reconstruction.html#jaxfluids.stencils.reconstruction.weno3_nn_opt2.WENO3NNOPT2">[docs]</a>
<span class="k">class</span> <span class="nc">WENO3NNOPT2</span><span class="p">(</span><span class="n">SpatialReconstruction</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nh</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">inactive_axis</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">WENO3NNOPT2</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">nh</span><span class="o">=</span><span class="n">nh</span><span class="p">,</span> <span class="n">inactive_axis</span><span class="o">=</span><span class="n">inactive_axis</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">dr_</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cr_</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]],</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]],</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_c_eno</span> <span class="o">=</span> <span class="mf">2e-4</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_stencil_size</span> <span class="o">=</span> <span class="mi">4</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_slices</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhz</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="n">j</span><span class="p">,</span>   <span class="bp">self</span><span class="o">.</span><span class="n">nhy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhz</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">,</span>   <span class="bp">self</span><span class="o">.</span><span class="n">nhy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhz</span><span class="p">],</span> <span class="p">],</span>  

                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhz</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="n">j</span><span class="p">,</span>   <span class="bp">self</span><span class="o">.</span><span class="n">nhz</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">,</span>   <span class="bp">self</span><span class="o">.</span><span class="n">nhz</span><span class="p">],</span> <span class="p">],</span>   

                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">,],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="n">j</span><span class="p">,</span>  <span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">,</span>  <span class="p">],</span> <span class="p">],</span>

            <span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_get_nn</span><span class="p">()</span>

<div class="viewcode-block" id="WENO3NNOPT2.set_slices_stencil">
<a class="viewcode-back" href="../../../../jaxfluids.stencils.reconstruction.html#jaxfluids.stencils.reconstruction.weno3_nn_opt2.WENO3NNOPT2.set_slices_stencil">[docs]</a>
    <span class="k">def</span> <span class="nf">set_slices_stencil</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slices</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span> <span class="p">],</span>   

                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span> <span class="p">],</span>

                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">],</span>
            <span class="p">],</span>

            <span class="p">[</span>
                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span> <span class="p">],</span>   

                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span> <span class="p">],</span>

                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">],</span>
            <span class="p">],</span>
        <span class="p">]</span></div>


<div class="viewcode-block" id="WENO3NNOPT2.reconstruct_xi">
<a class="viewcode-back" href="../../../../jaxfluids.stencils.reconstruction.html#jaxfluids.stencils.reconstruction.weno3_nn_opt2.WENO3NNOPT2.reconstruct_xi">[docs]</a>
    <span class="k">def</span> <span class="nf">reconstruct_xi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>

        <span class="n">s1_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slices</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">axis</span><span class="p">]</span>

        <span class="n">dx1</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">)</span>
        <span class="n">dx2</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">-</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="p">)</span>
        <span class="n">dx3</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">-</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">)</span>
        <span class="n">dx4</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">dx1</span><span class="p">,</span> <span class="n">dx2</span><span class="p">,</span> <span class="n">dx3</span><span class="p">,</span> <span class="n">dx4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> 
        <span class="n">x</span> <span class="o">/=</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">x</span><span class="p">[:,:,:,:,:</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[:,:,:,:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>

        <span class="n">omega_z_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">omega_z_</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">omega_z_</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c_eno</span><span class="p">)</span>
        <span class="n">omega_z_</span> <span class="o">/=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">omega_z_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">p_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cr_</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">cr_</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> 
        <span class="n">p_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cr_</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">cr_</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

        <span class="n">cell_state_xi_j</span> <span class="o">=</span> <span class="n">omega_z_</span><span class="p">[:,:,:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">p_0</span> <span class="o">+</span> <span class="n">omega_z_</span><span class="p">[:,:,:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">p_1</span>

        <span class="k">return</span> <span class="n">cell_state_xi_j</span></div>


    <span class="k">def</span> <span class="nf">_get_nn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                <span class="p">[</span><span class="mf">0.40507858789796725</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1238033098043017</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07371562056446773</span><span class="p">,</span> <span class="mf">0.6197903065864093</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.7930257586191607</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5625348147829258</span><span class="p">,</span> <span class="mf">0.8465590229867586</span><span class="p">,</span> <span class="mf">0.06934803250753911</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">1.6875939465011658</span><span class="p">,</span> <span class="mf">0.3292199251637992</span><span class="p">,</span> <span class="mf">0.6875138682901961</span><span class="p">,</span> <span class="mf">0.231016713716645</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.10912183489934689</span><span class="p">,</span> <span class="mf">0.2040961019258102</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6724587051169624</span><span class="p">,</span> <span class="mf">0.1312559439348201</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.3457073157356567</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.577544807826582</span><span class="p">,</span> <span class="mf">0.5509198901354974</span><span class="p">,</span> <span class="mf">0.8351369118279482</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.37393270139419627</span><span class="p">,</span> <span class="mf">0.5598127637781741</span><span class="p">,</span> <span class="mf">0.27320941345108146</span><span class="p">,</span> <span class="mf">0.8869608072658418</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.8098786896641792</span><span class="p">,</span> <span class="mf">0.169795217035407</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5372949484432187</span><span class="p">,</span> <span class="mf">0.15453353199037187</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">1.0839428877188175</span><span class="p">,</span> <span class="mf">0.5710929826178207</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5953756614768302</span><span class="p">,</span> <span class="mf">0.5340795193438068</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.5166080626653307</span><span class="p">,</span> <span class="mf">0.19059321138527613</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12020009736086794</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2785721649378586</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.6506865528977455</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5424805693979798</span><span class="p">,</span> <span class="mf">0.3941748861527991</span><span class="p">,</span> <span class="mf">0.36748233206516395</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.524897934490327</span><span class="p">,</span> <span class="mf">0.11506210069998385</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6009923660171071</span><span class="p">,</span> <span class="mf">0.2287483366027391</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.8388485695741124</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6359208318796294</span><span class="p">,</span> <span class="mf">0.7373071414776674</span><span class="p">,</span> <span class="mf">0.09497150456206503</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.42399921079425185</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8680738398303438</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6417461344232419</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7735348108564313</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.2915992280213219</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8328684447293676</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.42670822211750586</span><span class="p">,</span> <span class="mf">0.815257325426268</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">1.0245327666871027</span><span class="p">,</span> <span class="mf">0.2488354688859932</span><span class="p">,</span> <span class="mf">1.161907091201582</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9344205318644166</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.3853893818171449</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5444376846503562</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.39079519399401663</span><span class="p">,</span> <span class="mf">0.5409307745135028</span><span class="p">],</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

        <span class="n">w1</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.6867448131153827</span><span class="p">,</span> <span class="mf">0.5815513043168663</span><span class="p">,</span> <span class="mf">0.12472620573808167</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09514026577588723</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8582725029386706</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14471040125647194</span><span class="p">,</span> <span class="mf">0.0693429939306645</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14202011173748028</span><span class="p">,</span> <span class="mf">0.19108464106535772</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.16684878976327833</span><span class="p">,</span> <span class="mf">0.16984569067929595</span><span class="p">,</span> <span class="mf">0.10047832646320387</span><span class="p">,</span> <span class="mf">0.3153504002155991</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4409794087401472</span><span class="p">,</span> <span class="mf">0.7159675351797941</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6472042446455757</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.25598434385639846</span><span class="p">,</span> <span class="mf">0.2924590638828298</span><span class="p">,</span> <span class="mf">0.15686621245994514</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3999096307407229</span><span class="p">,</span> <span class="mf">0.5879345035507688</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1303807246107144</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.042125090119133304</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5359666252119695</span><span class="p">,</span> <span class="mf">0.14567316401367708</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.307905592962315</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5035822807059602</span><span class="p">,</span> <span class="mf">0.30354018336137517</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.19114699046394001</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25560165124070755</span><span class="p">,</span> <span class="mf">0.4140476810339576</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3139059266968657</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.04931941442363547</span><span class="p">,</span> <span class="mf">0.42081550312855154</span><span class="p">,</span> <span class="mf">0.19839695357598913</span><span class="p">,</span> <span class="mf">0.2147384236063682</span><span class="p">,</span> <span class="mf">0.4798402263136694</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.302871328795308</span><span class="p">,</span> <span class="mf">0.008479507226946244</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.484439404748177</span><span class="p">,</span> <span class="mf">0.05766963499483049</span><span class="p">,</span> <span class="mf">0.23406566886122618</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.48310265933937996</span><span class="p">,</span> <span class="mf">0.21714892360446778</span><span class="p">,</span> <span class="mf">0.23686420174208417</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04346353062517073</span><span class="p">,</span> <span class="mf">0.08295981300780145</span><span class="p">,</span> <span class="mf">0.25467847712980385</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.10606460702250393</span><span class="p">,</span> <span class="mf">0.1360114312531342</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3466175303554808</span><span class="p">,</span> <span class="mf">0.04748845846706956</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.30256915374228743</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.19698755571116694</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.38835299377340865</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6744351255429994</span><span class="p">,</span> <span class="mf">0.27810131946803684</span><span class="p">,</span> <span class="mf">0.3440400972929206</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08576255038954103</span><span class="p">,</span> <span class="mf">0.6253131015099894</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34306343661238725</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.49171672201713107</span><span class="p">,</span> <span class="mf">0.7413160377747086</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6018144383925759</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.3362148156723888</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17538147729740328</span><span class="p">,</span> <span class="mf">0.23385762816656955</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.28637505585429174</span><span class="p">,</span> <span class="mf">0.5734142860597128</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4654025808963523</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2526530345453943</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.41569870254200975</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.44372457643936186</span><span class="p">,</span> <span class="mf">0.3326457795637245</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03862362829354754</span><span class="p">,</span> <span class="mf">0.5187234029828613</span><span class="p">,</span> <span class="mf">0.3603121260262233</span><span class="p">,</span> <span class="mf">0.5176454505698286</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2046084510357694</span><span class="p">,</span> <span class="mf">0.2490394321789764</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.22282319086557204</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12331735126883088</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04881263948212592</span><span class="p">,</span> <span class="mf">0.10489217056547881</span><span class="p">,</span> <span class="mf">0.13633297223114244</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.37866838632586763</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15072815358243224</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4329889556196099</span><span class="p">,</span> <span class="mf">0.21277239435469658</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.36684710608938553</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1326218792795665</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09610391049541431</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1313446480188124</span><span class="p">,</span> <span class="mf">0.029274006381572036</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05832588226216447</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4481671940670486</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.15901584364081886</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18442203612739388</span><span class="p">,</span> <span class="mf">1.010736491366019</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.06105386169156317</span><span class="p">,</span> <span class="mf">0.10250697349588397</span><span class="p">,</span> <span class="mf">0.317729974287565</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09032523164359285</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5597691039280749</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.202389872687217</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18017776104880975</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05391953505364517</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7132008489017413</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.41234048323866823</span><span class="p">,</span> <span class="mf">0.23626333010541048</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7490903262962241</span><span class="p">,</span> <span class="mf">0.0853534736219293</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">1.2288842669282238</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1781522819219545</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.39991716688099505</span><span class="p">,</span> <span class="mf">0.09024699002470082</span><span class="p">,</span> <span class="mf">1.088897864322467</span><span class="p">,</span> <span class="mf">0.18566390313564027</span><span class="p">,</span> <span class="mf">0.32351788177560165</span><span class="p">,</span> <span class="mf">0.450773375365827</span><span class="p">,</span> <span class="mf">0.21092718656565712</span><span class="p">,</span> <span class="mf">0.4332396207110078</span><span class="p">,</span> <span class="mf">0.26812663364167444</span><span class="p">,</span> <span class="mf">0.34272707794803775</span><span class="p">,</span> <span class="mf">0.3368167332104344</span><span class="p">,</span> <span class="mf">0.9120772290800091</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.371239864217059</span><span class="p">,</span> <span class="mf">1.1106947298430088</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.009681468243199404</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1980815415893973</span><span class="p">,</span> <span class="mf">0.3850403437706827</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.30196145900118365</span><span class="p">,</span> <span class="mf">0.5116131127871133</span><span class="p">,</span> <span class="mf">0.5077391550810565</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.231073748570583</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2115859410886229</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.13138968077202287</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5367018129935034</span><span class="p">,</span> <span class="mf">0.14509991689038945</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.242566064196453</span><span class="p">,</span> <span class="mf">0.030884651763175234</span><span class="p">,</span> <span class="mf">0.5263408434094645</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26382048495066673</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3230218882556699</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.4319078552505818</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.43406243071567846</span><span class="p">,</span> <span class="mf">1.09657923818615</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.23881641721146615</span><span class="p">,</span> <span class="mf">0.6346093451443459</span><span class="p">,</span> <span class="mf">0.08231776039962466</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6940823557554685</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6433277909529731</span><span class="p">,</span> <span class="mf">0.006240600581396445</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4223884227319635</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7560336622323829</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.44020645707027395</span><span class="p">,</span> <span class="mf">0.16522556464579247</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.325386071770434</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4855309551128407</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.23886493949033488</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.55552575785334</span><span class="p">,</span> <span class="mf">0.48738265145824894</span><span class="p">,</span> <span class="mf">0.5671326425249802</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3157169511310578</span><span class="p">,</span> <span class="mf">1.072696174813921</span><span class="p">,</span> <span class="mf">0.38884352753773965</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6562727204384043</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4433377765799739</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3532972617324838</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1109383528337637</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.380024702827204</span><span class="p">,</span> <span class="mf">0.1688757887032817</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.592430855785699</span><span class="p">,</span> <span class="mf">0.3151394469962289</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6334047596253615</span><span class="p">,</span> <span class="mf">0.3749731598387512</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.06380307634387775</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.22004397176318183</span><span class="p">,</span> <span class="mf">0.861953056352305</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.022907372199960228</span><span class="p">,</span> <span class="mf">0.00807791591262222</span><span class="p">,</span> <span class="mf">0.03591242802854111</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25675960933370107</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.20427239352420398</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5293714366738514</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4409304869441713</span><span class="p">,</span> <span class="mf">0.10407305114573313</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0497069470103045</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.044246752155309474</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.13708515184868442</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.13240119099526648</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08252752088703741</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.17030919188718194</span><span class="p">,</span> <span class="mf">0.12985357633457414</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.21298657196607662</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08198966672079237</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12543289567890498</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.43550004091913314</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.003027406345337324</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.259570485598751</span><span class="p">,</span> <span class="mf">0.17837655170057992</span><span class="p">,</span> <span class="mf">0.2451724081305258</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2264436614696502</span><span class="p">,</span> <span class="mf">0.14324174792029915</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03387317739166384</span><span class="p">,</span> <span class="mf">0.4566799695801795</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5692360457237575</span><span class="p">,</span> <span class="mf">0.36586577679873133</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.3360543739769236</span><span class="p">,</span> <span class="mf">0.07225716315347526</span><span class="p">,</span> <span class="mf">0.10575298210966604</span><span class="p">,</span> <span class="mf">0.12658766840872324</span><span class="p">,</span> <span class="mf">0.029863516573593308</span><span class="p">,</span> <span class="mf">0.08117110151219442</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0731756396469054</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2747403771855847</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.193684962487218</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.21142953916018375</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.36670671648689557</span><span class="p">,</span> <span class="mf">0.10158770025440761</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.19561461589666734</span><span class="p">,</span> <span class="mf">0.278274790007805</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6169938397198013</span><span class="p">,</span> <span class="mf">0.020944104369647037</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.09942984441243542</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4506051572333583</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07446657965169429</span><span class="p">,</span> <span class="mf">0.3988818586779608</span><span class="p">,</span> <span class="mf">0.23585163792911798</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08615682323374707</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15668663896883833</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1651098591709022</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3356579662527265</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07445069202002452</span><span class="p">,</span> <span class="mf">0.24892441860406148</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.011615277672059748</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.148646383116846</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2240991359503305</span><span class="p">,</span> <span class="mf">0.0010432203765337207</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14205539414864182</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.8006697293108059</span><span class="p">,</span> <span class="mf">0.00018753968696219847</span><span class="p">,</span> <span class="mf">0.9955251031521111</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.41218282788057853</span><span class="p">,</span> <span class="mf">1.1972721626730496</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4006942812428122</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6089590583429121</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8631012327324826</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29134837945901426</span><span class="p">,</span> <span class="mf">0.3212744332291301</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29739041321556603</span><span class="p">,</span> <span class="mf">0.2924173679812099</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5789845337104051</span><span class="p">,</span> <span class="mf">0.3180317008567941</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0798161893518069</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29623412953423733</span><span class="p">],</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

        <span class="n">w2</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.8503863037662435</span><span class="p">,</span> <span class="mf">0.26973208467202026</span><span class="p">,</span> <span class="mf">0.07966412814352908</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8658865188933688</span><span class="p">,</span> <span class="mf">1.1495530217160335</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07538366652164888</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.051422009285308205</span><span class="p">,</span> <span class="mf">0.9790228404107725</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.45097152653464206</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7868869515993664</span><span class="p">,</span> <span class="mf">0.8391231489143977</span><span class="p">,</span> <span class="mf">0.21188836856761875</span><span class="p">,</span> <span class="mf">0.5632085983527626</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2847075319720688</span><span class="p">,</span> <span class="mf">0.13753507297624043</span><span class="p">,</span> <span class="mf">0.9798165935788753</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.45682769318340843</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.036525317167452914</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2318230991265981</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6938948736218584</span><span class="p">,</span> <span class="mf">0.18639919429407467</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08692137976843799</span><span class="p">,</span> <span class="mf">0.4271557260912461</span><span class="p">,</span> <span class="mf">0.2338891490372102</span><span class="p">,</span> <span class="mf">0.23542278056425953</span><span class="p">,</span> <span class="mf">0.281810660179581</span><span class="p">,</span> <span class="mf">0.15098081176465322</span><span class="p">,</span> <span class="mf">0.5001903365969637</span><span class="p">,</span> <span class="mf">0.47276522332312615</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.21156196754032178</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26441256307355193</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01316437747527656</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.47966232225774</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.33614322192456625</span><span class="p">,</span> <span class="mf">0.5527762347571665</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.38867828870805565</span><span class="p">,</span> <span class="mf">0.5410980467841571</span><span class="p">,</span> <span class="mf">0.11540847432348225</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.11564032945529601</span><span class="p">,</span> <span class="mf">0.3662821914751811</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17798823117584803</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.22999049581084044</span><span class="p">,</span> <span class="mf">0.44206744951544447</span><span class="p">,</span> <span class="mf">0.17616899465839322</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08401430965747712</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.27572034389696437</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29526376969654633</span><span class="p">,</span> <span class="mf">0.5390407145356501</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.33651303329475424</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2625623348024787</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05662055240142085</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08263908486613132</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.02711758813854524</span><span class="p">,</span> <span class="mf">0.26313810383087943</span><span class="p">,</span> <span class="mf">0.12169390408965944</span><span class="p">,</span> <span class="mf">0.4092023703649926</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.23277833778857812</span><span class="p">,</span> <span class="mf">0.2786806994258514</span><span class="p">,</span> <span class="mf">0.09738092831869469</span><span class="p">,</span> <span class="mf">0.2627158996901284</span><span class="p">,</span> <span class="mf">0.25437142889247705</span><span class="p">,</span> <span class="mf">0.09642521453352922</span><span class="p">,</span> <span class="mf">0.49010823491717204</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.006074281465504539</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.3638451160189469</span><span class="p">,</span> <span class="mf">0.4831194724176685</span><span class="p">,</span> <span class="mf">0.3818622476444646</span><span class="p">,</span> <span class="mf">0.2661715563422579</span><span class="p">,</span> <span class="mf">0.3134700933820883</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.42042791658219997</span><span class="p">,</span> <span class="mf">0.05477459029755421</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18822440287853998</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.36039899564912325</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.22080260091725798</span><span class="p">,</span> <span class="mf">0.33737377062555535</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4089619699638205</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.001797980195123386</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3279778550557059</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.36707722140288945</span><span class="p">,</span> <span class="mf">0.4272713756164122</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.22739460374608986</span><span class="p">,</span> <span class="mf">0.08073984940667196</span><span class="p">,</span> <span class="mf">0.28294000461116964</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15330560228510942</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.025460965375753767</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26588529697983276</span><span class="p">,</span> <span class="mf">0.1740175012698221</span><span class="p">,</span> <span class="mf">0.030864410340264593</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.075615602281047</span><span class="p">,</span> <span class="mf">0.14391610838238905</span><span class="p">,</span> <span class="mf">0.3343806905449929</span><span class="p">,</span> <span class="mf">0.06242522243019465</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12714582995069187</span><span class="p">,</span> <span class="mf">0.35705181738640546</span><span class="p">,</span> <span class="mf">0.32688987936549463</span><span class="p">,</span> <span class="mf">0.11307004065183536</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.10085937651296571</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.16558459105218393</span><span class="p">,</span> <span class="mf">0.2799860763749076</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.23520594567790945</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3595142398796619</span><span class="p">,</span> <span class="mf">0.27959380399797606</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.057934232989528836</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.24700787600201637</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.20277391917134385</span><span class="p">,</span> <span class="mf">0.1745148448472533</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.23144012045352091</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07776276627380775</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.13130535608245342</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.13650675543344434</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3334147496132178</span><span class="p">,</span> <span class="mf">0.045684811163875634</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.1280107502374298</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.313264739617544</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07086366896849243</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4166270333527426</span><span class="p">,</span> <span class="mf">0.3629840712639312</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12894250828517895</span><span class="p">,</span> <span class="mf">0.6892314171107886</span><span class="p">,</span> <span class="mf">0.43220159424221044</span><span class="p">,</span> <span class="mf">0.726858895519226</span><span class="p">,</span> <span class="mf">0.7658025001460358</span><span class="p">,</span> <span class="mf">0.2556005056207057</span><span class="p">,</span> <span class="mf">0.5616048455905793</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.23453347256630908</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12353533570435427</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07283126806225097</span><span class="p">,</span> <span class="mf">0.354922517887608</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.05600316563708509</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.302568376886732</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3034615753299236</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.749603857174122</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18277014622811583</span><span class="p">,</span> <span class="mf">0.3243303236732084</span><span class="p">,</span> <span class="mf">0.987677111484863</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34822747616526173</span><span class="p">,</span> <span class="mf">0.6746123217747416</span><span class="p">,</span> <span class="mf">1.4336167682825305</span><span class="p">,</span> <span class="mf">0.18388256202543724</span><span class="p">,</span> <span class="mf">1.317414007169706</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08395969734448974</span><span class="p">,</span> <span class="mf">0.5641086635579612</span><span class="p">,</span> <span class="mf">0.6326894524646852</span><span class="p">,</span> <span class="mf">0.4067340434542997</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.2553791836590051</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.035585588247976835</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6008985731854996</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6076502942481172</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.420309929408639</span><span class="p">,</span> <span class="mf">0.040154285545409486</span><span class="p">,</span> <span class="mf">0.7036324980588307</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5234350082611118</span><span class="p">,</span> <span class="mf">0.9444158898256386</span><span class="p">,</span> <span class="mf">1.49620817248008</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.005420579514536696</span><span class="p">,</span> <span class="mf">0.8226455944507565</span><span class="p">,</span> <span class="mf">0.2043063233960032</span><span class="p">,</span> <span class="mf">0.5516683915340641</span><span class="p">,</span> <span class="mf">0.10811084759508162</span><span class="p">,</span> <span class="mf">0.7573676312853309</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.3952441290064368</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08197590906541201</span><span class="p">,</span> <span class="mf">0.4742425308603112</span><span class="p">,</span> <span class="mf">0.12909677697509667</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09778749291814226</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.21428635730430712</span><span class="p">,</span> <span class="mf">0.2518560771333552</span><span class="p">,</span> <span class="mf">0.0430880022633686</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34294736487133415</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3883980233811578</span><span class="p">,</span> <span class="mf">0.28230825119321645</span><span class="p">,</span> <span class="mf">0.13597232781367566</span><span class="p">,</span> <span class="mf">0.3198949234371617</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17425052935589203</span><span class="p">,</span> <span class="mf">0.3001814674220904</span><span class="p">,</span> <span class="mf">0.11999221570345685</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.3394988609436981</span><span class="p">,</span> <span class="mf">0.4450757862566428</span><span class="p">,</span> <span class="mf">0.3883776323913531</span><span class="p">,</span> <span class="mf">0.6033192602734934</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.330605787553949</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3039758963642952</span><span class="p">,</span> <span class="mf">0.3339389184955664</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.185249934742437</span><span class="p">,</span> <span class="mf">0.3772774637143086</span><span class="p">,</span> <span class="mf">0.5262690792199758</span><span class="p">,</span> <span class="mf">0.14159969353513202</span><span class="p">,</span> <span class="mf">0.2278647779768446</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3364371614428228</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.31885624025612996</span><span class="p">,</span> <span class="mf">0.40682941997723493</span><span class="p">,</span> <span class="mf">0.3184524655357961</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.2004113305938361</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5160984754659198</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.41117325461795473</span><span class="p">,</span> <span class="mf">0.1187011432405939</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.020815395321570396</span><span class="p">,</span> <span class="mf">0.12133386301577685</span><span class="p">,</span> <span class="mf">0.456446878707769</span><span class="p">,</span> <span class="mf">0.2046776227718532</span><span class="p">,</span> <span class="mf">0.18685395539330546</span><span class="p">,</span> <span class="mf">0.8169487384698053</span><span class="p">,</span> <span class="mf">0.5734201358781507</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.28092383162590717</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10161694125370713</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09170941393805067</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3438320456550242</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.24190006641714637</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.5867052808521479</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.24905993543305086</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.007894901023279215</span><span class="p">,</span> <span class="mf">0.17849035708769956</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.20289093545912645</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.020175655540982978</span><span class="p">,</span> <span class="mf">0.5556763101439157</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7056814087563544</span><span class="p">,</span> <span class="mf">0.03429057057746626</span><span class="p">,</span> <span class="mf">0.7564588003286788</span><span class="p">,</span> <span class="mf">0.3498718416352649</span><span class="p">,</span> <span class="mf">0.3357835156668993</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3323015730280598</span><span class="p">,</span> <span class="mf">0.43726171529886276</span><span class="p">,</span> <span class="mf">0.006942164304266475</span><span class="p">,</span> <span class="mf">0.31696278631408586</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0073176892223145535</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3132720547759719</span><span class="p">,</span> <span class="mf">0.4343701381020824</span><span class="p">,</span> <span class="mf">0.37163779979624517</span><span class="p">,</span> <span class="mf">0.1271626570931177</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1008318807985456</span><span class="p">,</span> <span class="mf">0.19247929941650477</span><span class="p">,</span> <span class="mf">0.224241479817544</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.029629632482364304</span><span class="p">,</span> <span class="mf">0.2589529207511819</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.40260892343668725</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.28601646006073816</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2530608866364776</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3314749286164843</span><span class="p">,</span> <span class="mf">0.33300952808836914</span><span class="p">,</span> <span class="mf">0.036790519034176954</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.11734447732537494</span><span class="p">,</span> <span class="mf">0.12174707127590667</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17387651803473045</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.31779710200006395</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05273178706791511</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07512018911032277</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3888080148169517</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07322424612717245</span><span class="p">,</span> <span class="mf">0.28357185811745633</span><span class="p">,</span> <span class="mf">0.023591599823268423</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15012507910438574</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15798134219898938</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18619351366589146</span><span class="p">,</span> <span class="mf">0.053468330459870796</span><span class="p">,</span> <span class="mf">0.20471727323629585</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0713039829710401</span><span class="p">],</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        
        <span class="n">w3</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="mf">0.11691632192709213</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5809594599696845</span><span class="p">,</span> <span class="mf">0.39381126545278994</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.11458144569683075</span><span class="p">,</span> <span class="mf">0.2915800947381822</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15832487965860276</span><span class="p">,</span> <span class="mf">0.1369483690040619</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7025255535779401</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.52684924123905</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4198672446947172</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.06123437567379799</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7512464259031908</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7650905649264873</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.39969769870438354</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04659053308762004</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2678712762974846</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.8767801130673146</span><span class="p">,</span> <span class="mf">0.4601717900455377</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05132525856913018</span><span class="p">,</span> <span class="mf">0.44855110521788133</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6449745416787377</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.27889856392603646</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.410660305614706</span><span class="p">,</span> <span class="mf">0.5594501700581663</span><span class="p">,</span> <span class="mf">0.317268176966285</span><span class="p">,</span> <span class="mf">0.5867561684781535</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.678346069837083</span><span class="p">,</span> <span class="mf">0.24462363106285678</span><span class="p">,</span> <span class="mf">0.3916154422007198</span><span class="p">,</span> <span class="mf">0.6844529377238694</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5865824496546097</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3857274274616773</span><span class="p">],</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

        <span class="n">b</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="mf">0.255752943202295</span><span class="p">,</span> <span class="mf">0.19702783673282653</span><span class="p">,</span> <span class="mf">0.24858735401570572</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1252846548840331</span><span class="p">,</span> <span class="mf">0.2815230793317552</span><span class="p">,</span> <span class="mf">0.13979702661104412</span><span class="p">,</span> <span class="mf">0.053620718304894587</span><span class="p">,</span> <span class="mf">0.0033978894001451534</span><span class="p">,</span>
            <span class="mf">0.3825015948978667</span><span class="p">,</span> <span class="mf">0.03821449844202758</span><span class="p">,</span> <span class="mf">0.09008965756403677</span><span class="p">,</span> <span class="mf">0.19467940108203366</span><span class="p">,</span> <span class="mf">0.31294371207869265</span><span class="p">,</span> <span class="mf">0.18275503325976908</span><span class="p">,</span> <span class="mf">0.571428363835027</span><span class="p">,</span> <span class="mf">0.13578580279418276</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

        <span class="n">b1</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="mf">0.0012693931383079586</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01640847107615524</span><span class="p">,</span> <span class="mf">0.030536316484409697</span><span class="p">,</span> <span class="mf">0.13395179363202533</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.028180473694846275</span><span class="p">,</span> <span class="mf">0.03442145821752985</span><span class="p">,</span> <span class="mf">0.12747046885575897</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.06768319541892545</span><span class="p">,</span>
            <span class="mf">0.1605257693365629</span><span class="p">,</span> <span class="mf">0.13533733885832608</span><span class="p">,</span> <span class="mf">0.06484267197449477</span><span class="p">,</span> <span class="mf">0.06299802475582032</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04502310622483803</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.06214246143576937</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09404026146645263</span><span class="p">,</span> <span class="mf">0.042979795410095216</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

        <span class="n">b2</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="mf">0.12204247764854607</span><span class="p">,</span> <span class="mf">0.08112763087584626</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00402684696986431</span><span class="p">,</span> <span class="mf">0.037542507461046294</span><span class="p">,</span> <span class="mf">0.0026271480327488086</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.06454833917396394</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.06081250143514959</span><span class="p">,</span> <span class="mf">0.11725409888413155</span><span class="p">,</span>
            <span class="mf">0.04075150077076115</span><span class="p">,</span> <span class="mf">0.033639503573095274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.012716427102788417</span><span class="p">,</span> <span class="mf">0.07539504190485471</span><span class="p">,</span> <span class="mf">0.07803680531271559</span><span class="p">,</span> <span class="mf">0.01777794957869979</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.049570569756576074</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0606558939078927</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

        <span class="n">b3</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="o">-</span><span class="mf">0.03701019424088373</span><span class="p">,</span> <span class="mf">0.03701019424088411</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;linear&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;w&#39;</span><span class="p">:</span> <span class="n">w</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">b</span><span class="p">,},</span>
            <span class="s1">&#39;linear_1&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;w&#39;</span><span class="p">:</span> <span class="n">w1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">b1</span><span class="p">,},</span>
            <span class="s1">&#39;linear_2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;w&#39;</span><span class="p">:</span> <span class="n">w2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">b2</span><span class="p">,},</span>
            <span class="s1">&#39;linear_3&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;w&#39;</span><span class="p">:</span> <span class="n">w3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">b3</span><span class="p">,},</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">data_structures</span><span class="o">.</span><span class="n">to_immutable_dict</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
        <span class="k">def</span> <span class="nf">net_fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">mlp</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
                <span class="n">hk</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">swish</span><span class="p">,</span>
                <span class="n">hk</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">swish</span><span class="p">,</span>
                <span class="n">hk</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">swish</span><span class="p">,</span>
                <span class="n">hk</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">,</span>
            <span class="p">])</span>
            <span class="k">return</span> <span class="n">mlp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">without_apply_rng</span><span class="p">(</span><span class="n">hk</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">net_fn</span><span class="p">))</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Chair of Aerodynamics and Fluid Mechanics, Technical University of Munich.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>