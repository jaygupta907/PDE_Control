<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>jaxfluids.stencils.reconstruction.weno3_nn_opt1 &mdash; jaxfluids 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=01f34227"></script>
        <script src="../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            jaxfluids
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">JAX-Fluids: First steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../runsimulation.html">Run Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Under the hood</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../available_modules.html">Available modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../change_log.html">Change log</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">JAX-Fluids API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../jaxfluids.html">jaxfluids package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contact</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../authors.html">Authors</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">jaxfluids</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">jaxfluids.stencils.reconstruction.weno3_nn_opt1</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for jaxfluids.stencils.reconstruction.weno3_nn_opt1</h1><div class="highlight"><pre>
<span></span><span class="c1">#*------------------------------------------------------------------------------*</span>
<span class="c1">#* JAX-FLUIDS -                                                                 *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#* A fully-differentiable CFD solver for compressible two-phase flows.          *</span>
<span class="c1">#* Copyright (C) 2022  Deniz A. Bezgin, Aaron B. Buhendwa, Nikolaus A. Adams    *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#* This program is free software: you can redistribute it and/or modify         *</span>
<span class="c1">#* it under the terms of the GNU General Public License as published by         *</span>
<span class="c1">#* the Free Software Foundation, either version 3 of the License, or            *</span>
<span class="c1">#* (at your option) any later version.                                          *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#* This program is distributed in the hope that it will be useful,              *</span>
<span class="c1">#* but WITHOUT ANY WARRANTY; without even the implied warranty of               *</span>
<span class="c1">#* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                *</span>
<span class="c1">#* GNU General Public License for more details.                                 *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#* You should have received a copy of the GNU General Public License            *</span>
<span class="c1">#* along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.       *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#*------------------------------------------------------------------------------*</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#* CONTACT                                                                      *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#* deniz.bezgin@tum.de // aaron.buhendwa@tum.de // nikolaus.adams@tum.de        *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#*------------------------------------------------------------------------------*</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#* Munich, April 15th, 2022                                                     *</span>
<span class="c1">#*                                                                              *</span>
<span class="c1">#*------------------------------------------------------------------------------*</span>

<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">import</span> <span class="nn">haiku</span> <span class="k">as</span> <span class="nn">hk</span>
<span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>

<span class="kn">from</span> <span class="nn">jaxfluids.stencils.spatial_reconstruction</span> <span class="kn">import</span> <span class="n">SpatialReconstruction</span>

<div class="viewcode-block" id="WENO3NNOPT1">
<a class="viewcode-back" href="../../../../jaxfluids.stencils.reconstruction.html#jaxfluids.stencils.reconstruction.weno3_nn_opt1.WENO3NNOPT1">[docs]</a>
<span class="k">class</span> <span class="nc">WENO3NNOPT1</span><span class="p">(</span><span class="n">SpatialReconstruction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;WENO3NNOPT1</span>

<span class="sd">    Bezgin et al. - 2021 - </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nh</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">inactive_axis</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">WENO3NNOPT1</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">nh</span><span class="o">=</span><span class="n">nh</span><span class="p">,</span> <span class="n">inactive_axis</span><span class="o">=</span><span class="n">inactive_axis</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">dr_</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cr_</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]],</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]],</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_c_eno</span> <span class="o">=</span> <span class="mf">2e-4</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_stencil_size</span> <span class="o">=</span> <span class="mi">4</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_slices</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhz</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="n">j</span><span class="p">,</span>   <span class="bp">self</span><span class="o">.</span><span class="n">nhy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhz</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">,</span>   <span class="bp">self</span><span class="o">.</span><span class="n">nhy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhz</span><span class="p">],</span> <span class="p">],</span>  

                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhz</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="n">j</span><span class="p">,</span>   <span class="bp">self</span><span class="o">.</span><span class="n">nhz</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">,</span>   <span class="bp">self</span><span class="o">.</span><span class="n">nhz</span><span class="p">],</span> <span class="p">],</span>   

                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">,],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="n">j</span><span class="p">,</span>  <span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nhy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">,</span>  <span class="p">],</span> <span class="p">],</span>

            <span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_get_nn</span><span class="p">()</span>

<div class="viewcode-block" id="WENO3NNOPT1.set_slices_stencil">
<a class="viewcode-back" href="../../../../jaxfluids.stencils.reconstruction.html#jaxfluids.stencils.reconstruction.weno3_nn_opt1.WENO3NNOPT1.set_slices_stencil">[docs]</a>
    <span class="k">def</span> <span class="nf">set_slices_stencil</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slices</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span> <span class="p">],</span>   

                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span> <span class="p">],</span>

                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">],</span>
            <span class="p">],</span>

            <span class="p">[</span>
                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span> <span class="p">],</span>   

                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">],</span> <span class="p">],</span>

                <span class="p">[</span>   <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>  
                    <span class="n">jnp</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">],</span>
            <span class="p">],</span>
        <span class="p">]</span></div>


<div class="viewcode-block" id="WENO3NNOPT1.reconstruct_xi">
<a class="viewcode-back" href="../../../../jaxfluids.stencils.reconstruction.html#jaxfluids.stencils.reconstruction.weno3_nn_opt1.WENO3NNOPT1.reconstruct_xi">[docs]</a>
    <span class="k">def</span> <span class="nf">reconstruct_xi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">s1_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slices</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">axis</span><span class="p">]</span>

        <span class="n">dx1</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">)</span>
        <span class="n">dx2</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">-</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="p">)</span>
        <span class="n">dx3</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">-</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">)</span>
        <span class="n">dx4</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">dx1</span><span class="p">,</span> <span class="n">dx2</span><span class="p">,</span> <span class="n">dx3</span><span class="p">,</span> <span class="n">dx4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> 
        <span class="n">x</span> <span class="o">/=</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">x</span><span class="p">[:,:,:,:,:</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[:,:,:,:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>

        <span class="n">omega_z_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">omega_z_</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">omega_z_</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c_eno</span><span class="p">)</span>
        <span class="n">omega_z_</span> <span class="o">/=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">omega_z_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">p_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cr_</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">cr_</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> 
        <span class="n">p_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cr_</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">cr_</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">buffer</span><span class="p">[</span><span class="n">s1_</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

        <span class="n">cell_state_xi_j</span> <span class="o">=</span> <span class="n">omega_z_</span><span class="p">[:,:,:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">p_0</span> <span class="o">+</span> <span class="n">omega_z_</span><span class="p">[:,:,:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">p_1</span>

        <span class="k">return</span> <span class="n">cell_state_xi_j</span></div>


    <span class="k">def</span> <span class="nf">_get_nn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">3.3636199430413627</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7351760486626531</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0380715848953586</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10683684612079541</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.6320153775249236</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25063347973585137</span><span class="p">,</span> <span class="mf">0.9391343557951499</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5485699790719365</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.48572636212321973</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.19663348669125083</span><span class="p">,</span> <span class="mf">0.593751506792153</span><span class="p">,</span> <span class="mf">0.37210723908968374</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.30279189440268434</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5747518777720824</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18765553236960378</span><span class="p">,</span> <span class="mf">0.5617584946856855</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.9698969495831152</span><span class="p">,</span> <span class="mf">0.3886446134687482</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.128269159726216</span><span class="p">,</span> <span class="mf">0.2593053476193478</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.5574079110033463</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9599209486951579</span><span class="p">,</span> <span class="mf">0.02395137931149818</span><span class="p">,</span> <span class="mf">0.05355918238361052</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.8102211002151866</span><span class="p">,</span> <span class="mf">0.3799165797496963</span><span class="p">,</span> <span class="mf">0.7634586940042873</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.122915300744421</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.8185890553975251</span><span class="p">,</span> <span class="mf">0.24799345538559422</span><span class="p">,</span> <span class="mf">0.47720309136792444</span><span class="p">,</span> <span class="mf">0.02614474430945657</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.5654335001434448</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.225339449727529</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0445224691137319</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.057350544935499556</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">1.037315695984657</span><span class="p">,</span> <span class="mf">0.5506128559787825</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18710096179291355</span><span class="p">,</span> <span class="mf">0.44242980846989893</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.3047941181045883</span><span class="p">,</span> <span class="mf">0.21408484021935992</span><span class="p">,</span> <span class="mf">0.3216093649696904</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.06647501451265608</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.5784548672177117</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.525901002632359</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.40231258078718646</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.514536341833738</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.6885144337241698</span><span class="p">,</span> <span class="mf">0.07727692424146439</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.002517270427443718</span><span class="p">,</span> <span class="mf">0.12648842758609685</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.5141463730415861</span><span class="p">,</span> <span class="mf">0.6308603138360143</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18660424435683695</span><span class="p">,</span> <span class="mf">0.7089138604963139</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.08242892614298822</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7327836826685112</span><span class="p">,</span> <span class="mf">0.3262208988224903</span><span class="p">,</span> <span class="mf">0.2906869687847254</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.28374813431860063</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.36484459817691434</span><span class="p">,</span> <span class="mf">0.024480049936531603</span><span class="p">,</span> <span class="mf">0.5142434385581227</span><span class="p">],</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

        <span class="n">w1</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.5781986969868682</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.44393846962070416</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.39001715876042886</span><span class="p">,</span> <span class="mf">0.15156837812597834</span><span class="p">,</span> <span class="mf">0.5523831427370872</span><span class="p">,</span> <span class="mf">0.08234243151891239</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.19660180924651052</span><span class="p">,</span> <span class="mf">0.04858237091898023</span><span class="p">,</span> <span class="mf">0.20997633375361266</span><span class="p">,</span> <span class="mf">0.8082310225107752</span><span class="p">,</span> <span class="mf">0.2910698992652692</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.27559680454580876</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.37582930442611656</span><span class="p">,</span> <span class="mf">0.6414809089603271</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10161600751871838</span><span class="p">,</span> <span class="mf">0.12462173639634255</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.39227854973151793</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1918000966649267</span><span class="p">,</span> <span class="mf">0.19432514394815054</span><span class="p">,</span> <span class="mf">0.36070415015106105</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4233795233411991</span><span class="p">,</span> <span class="mf">0.5057178756681626</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5082012057887959</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.36011441650327125</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05787874209449309</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.20720192703198212</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.39847677235058293</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12093537821090297</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.30257795904161094</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.45580621657790105</span><span class="p">,</span> <span class="mf">0.5854224930452867</span><span class="p">,</span> <span class="mf">0.4312881666082077</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.08399129667126241</span><span class="p">,</span> <span class="mf">0.7204755063035373</span><span class="p">,</span> <span class="mf">0.2642161852952745</span><span class="p">,</span> <span class="mf">0.05356348026512046</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.48752393497195906</span><span class="p">,</span> <span class="mf">0.30696390499747456</span><span class="p">,</span> <span class="mf">0.4110563728472665</span><span class="p">,</span> <span class="mf">0.6468482798331587</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.23285755642187478</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2960279705133975</span><span class="p">,</span> <span class="mf">0.13322513579967582</span><span class="p">,</span> <span class="mf">0.10992804995050258</span><span class="p">,</span> <span class="mf">0.329363785487234</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.16360705604874587</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.06909576905127189</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1005487783484379</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.38177986948152814</span><span class="p">,</span> <span class="mf">0.5999826900783087</span><span class="p">,</span> <span class="mf">0.2183569724742987</span><span class="p">,</span> <span class="mf">0.15781690480489577</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17390355857547576</span><span class="p">,</span> <span class="mf">0.31242899658625783</span><span class="p">,</span> <span class="mf">0.2958823791998624</span><span class="p">,</span> <span class="mf">0.41593263428031857</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2581463621018953</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.019593523658324175</span><span class="p">,</span> <span class="mf">0.08318999089346635</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5097292078190624</span><span class="p">,</span> <span class="mf">0.2214382243699303</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2971695892224367</span><span class="p">,</span> <span class="mf">0.2965797033176569</span><span class="p">,</span> <span class="mf">0.1195967034093866</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.45716982517830773</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.341113377170982</span><span class="p">,</span> <span class="mf">0.25459599721595</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18627777067840412</span><span class="p">,</span> <span class="mf">0.2358387265604964</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07224043620241215</span><span class="p">,</span> <span class="mf">0.10284502498191694</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5122070791509102</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.41203733660561054</span><span class="p">,</span> <span class="mf">0.44583945582143847</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.189311685363244</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10107807871597048</span><span class="p">,</span> <span class="mf">0.32357783898839254</span><span class="p">,</span> <span class="mf">0.2785610843782067</span><span class="p">,</span> <span class="mf">0.1810028252930368</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.124881394414201</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.0353037067346609</span><span class="p">,</span> <span class="mf">0.14156000575486577</span><span class="p">,</span> <span class="mf">0.22809796243619557</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.11505112548996929</span><span class="p">,</span> <span class="mf">0.01240625154618994</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3301017091488843</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6095770411385663</span><span class="p">,</span> <span class="mf">0.3253977917998842</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.48011173168384336</span><span class="p">,</span> <span class="mf">0.7428002308535165</span><span class="p">,</span> <span class="mf">0.5141368386034507</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4494603644026563</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2211206684351633</span><span class="p">,</span> <span class="mf">0.03214893053827113</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10423509275225028</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15668608366740377</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.19820194376319525</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0796110775135772</span><span class="p">,</span> <span class="mf">0.6601722495731629</span><span class="p">,</span> <span class="mf">2.16155152333764</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6272726174953362</span><span class="p">,</span> <span class="mf">0.4771276707641084</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.786815212210548</span><span class="p">,</span> <span class="mf">0.11380838404166727</span><span class="p">,</span> <span class="mf">0.774705776618212</span><span class="p">,</span> <span class="mf">0.2240127981655552</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.28521239015789807</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.28379425058820906</span><span class="p">,</span> <span class="mf">0.009332415882640105</span><span class="p">,</span> <span class="mf">0.7549354868171777</span><span class="p">,</span> <span class="mf">0.3278654758928927</span><span class="p">,</span> <span class="mf">1.8689216230445014</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.5673592867337381</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5870289638071496</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.28760990140325143</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2599390593957131</span><span class="p">,</span> <span class="mf">0.7333289409970646</span><span class="p">,</span> <span class="mf">0.017882429207095586</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5140847740857992</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3724027155240346</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.45829486022473814</span><span class="p">,</span> <span class="mf">0.9380880379918737</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.005436870947663284</span><span class="p">,</span> <span class="mf">0.10347460955583197</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.43524837376968234</span><span class="p">,</span> <span class="mf">0.6450218331638167</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.11393420240350285</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5325005110481795</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.1578167281346622</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4990072663887819</span><span class="p">,</span> <span class="mf">0.16061424981935077</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.11930332701526178</span><span class="p">,</span> <span class="mf">0.23879871652365614</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3728781843574354</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6482446979009322</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.46328301844968905</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2510903891750089</span><span class="p">,</span> <span class="mf">0.09479182227436657</span><span class="p">,</span> <span class="mf">0.21963357463275465</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3986999441843772</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.13177535742921062</span><span class="p">,</span> <span class="mf">0.23867835492583583</span><span class="p">,</span> <span class="mf">0.31998838765086923</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35186289223678235</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.23628558923758308</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2927580930402581</span><span class="p">,</span> <span class="mf">0.46194674374290445</span><span class="p">,</span> <span class="mf">0.1008639903490192</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.40247250944021706</span><span class="p">,</span> <span class="mf">0.2627736314469531</span><span class="p">,</span> <span class="mf">0.15940045835220074</span><span class="p">,</span> <span class="mf">0.5062559263751959</span><span class="p">,</span> <span class="mf">0.4916095242072076</span><span class="p">,</span> <span class="mf">0.1876385551979399</span><span class="p">,</span> <span class="mf">0.136008414916649</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.058497968208373975</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03413857101302722</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.37589354033821465</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.16538151313499982</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26290759603192415</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.4884809314198987</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5073030589542719</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4490378987182159</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.23273730858527866</span><span class="p">,</span> <span class="mf">0.6893768087707252</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04388510795013468</span><span class="p">,</span> <span class="mf">0.042476460407702005</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.27972192333461743</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3677331941407762</span><span class="p">,</span> <span class="mf">0.11595050664917898</span><span class="p">,</span> <span class="mf">0.4719638957470959</span><span class="p">,</span> <span class="mf">0.07589890845910985</span><span class="p">,</span> <span class="mf">0.15642530187537587</span><span class="p">,</span> <span class="mf">0.6168817045308265</span><span class="p">,</span> <span class="mf">0.19778089011940284</span><span class="p">,</span> <span class="mf">0.0108163613627861</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.1085494595082266</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4259569139134789</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3588220940964178</span><span class="p">,</span> <span class="mf">0.09827255616441233</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2109427038074598</span><span class="p">,</span> <span class="mf">0.1921765596648278</span><span class="p">,</span> <span class="mf">0.19033789382911273</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4254009926990324</span><span class="p">,</span> <span class="mf">0.14840230873184765</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0918427678660932</span><span class="p">,</span> <span class="mf">0.2106647515268193</span><span class="p">,</span> <span class="mf">0.28514101952346144</span><span class="p">,</span> <span class="mf">0.31248571876255943</span><span class="p">,</span> <span class="mf">0.21192684985220675</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.018668804356491115</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08496544417057687</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.19326764320398732</span><span class="p">,</span> <span class="mf">0.17832736265067736</span><span class="p">,</span> <span class="mf">0.019234758905393067</span><span class="p">,</span> <span class="mf">0.06140130771238733</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15489571751873152</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07855547735747531</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01775747135144814</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03403266791260739</span><span class="p">,</span> <span class="mf">0.16038211452159334</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2509163806863737</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.048558917194135943</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09124566191338812</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3699442484162329</span><span class="p">,</span> <span class="mf">0.29123811432696783</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.21187610777897023</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3339325710077664</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.23024531152705982</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.22397400313577948</span><span class="p">,</span> <span class="mf">0.4061273989699611</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.20156610952835874</span><span class="p">,</span> <span class="mf">0.04414084889252632</span><span class="p">,</span> <span class="mf">0.42298501033862435</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05075944138678446</span><span class="p">,</span> <span class="mf">0.13202879275565935</span><span class="p">,</span> <span class="mf">0.13782982633720106</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.49114424688552344</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18090842462474338</span><span class="p">,</span> <span class="mf">0.24531095418745616</span><span class="p">,</span> <span class="mf">0.30092951828382397</span><span class="p">,</span> <span class="mf">0.1481427745164258</span><span class="p">,</span> <span class="mf">0.08541398353765514</span><span class="p">,</span> <span class="mf">0.17416186757007607</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.25839918655426075</span><span class="p">,</span> <span class="mf">0.033529882774553654</span><span class="p">,</span> <span class="mf">0.1958799501134463</span><span class="p">,</span> <span class="mf">0.2667829730791037</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4279307261642568</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.20778673894258295</span><span class="p">,</span> <span class="mf">0.020110322946891204</span><span class="p">,</span> <span class="mf">0.09106997980365195</span><span class="p">,</span> <span class="mf">0.09180439878510975</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.43247608905018603</span><span class="p">,</span> <span class="mf">0.2713787812997134</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.23250192561918043</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.36603026790450405</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18651883959370552</span><span class="p">,</span> <span class="mf">0.3076164181940168</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03699973230679113</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.4451855535736983</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3243173337346472</span><span class="p">,</span> <span class="mf">0.4241481537039716</span><span class="p">,</span> <span class="mf">0.30899289824381876</span><span class="p">,</span> <span class="mf">0.3836547649789459</span><span class="p">,</span> <span class="mf">0.34770207876696324</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2155438040097826</span><span class="p">,</span> <span class="mf">0.1465518196648991</span><span class="p">,</span> <span class="mf">0.06244619664849472</span><span class="p">,</span> <span class="mf">1.3558040814537398</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1411293164081895</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5841960373619205</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3111101226240681</span><span class="p">,</span> <span class="mf">0.4932475298289673</span><span class="p">,</span> <span class="mf">0.33155955230178613</span><span class="p">,</span> <span class="mf">0.9777725670116078</span><span class="p">],</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

        <span class="n">w2</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="mf">0.10107902072398287</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.025850661059006134</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.19405547248473773</span><span class="p">,</span> <span class="mf">0.2922344182722797</span><span class="p">,</span> <span class="mf">0.0954835967615693</span><span class="p">,</span> <span class="mf">0.14971467819759163</span><span class="p">,</span> <span class="mf">0.06273866656512406</span><span class="p">,</span> <span class="mf">0.05919403856321677</span><span class="p">,</span> <span class="mf">0.2630383059121237</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25573502654448665</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.22771517316143927</span><span class="p">,</span> <span class="mf">0.09028140908102353</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26023294768832844</span><span class="p">,</span> <span class="mf">0.13859784198621147</span><span class="p">,</span> <span class="mf">0.35437595293605156</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1948033337523156</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.25474606013323137</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1743718887032992</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.007806759477912259</span><span class="p">,</span> <span class="mf">0.13146786895513518</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1787785506275865</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14397681256558428</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.13372479795797798</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.055257674739710376</span><span class="p">,</span> <span class="mf">0.0663616094328213</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12828240106312938</span><span class="p">,</span> <span class="mf">0.12993065398275586</span><span class="p">,</span> <span class="mf">0.08818574812732052</span><span class="p">,</span> <span class="mf">0.19901560901730792</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.27048213282495526</span><span class="p">,</span> <span class="mf">0.21843981810881444</span><span class="p">,</span> <span class="mf">0.1036569832262954</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.20949870960605815</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.053613311238269394</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.368186672429691</span><span class="p">,</span> <span class="mf">0.11200006869443371</span><span class="p">,</span> <span class="mf">0.0922693135202921</span><span class="p">,</span> <span class="mf">0.055838300176904256</span><span class="p">,</span> <span class="mf">0.42076818248035597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2886726484207812</span><span class="p">,</span> <span class="mf">0.25273040495394183</span><span class="p">,</span> <span class="mf">0.11864780556264957</span><span class="p">,</span> <span class="mf">0.09802992187170148</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2237911421534205</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3619321832783275</span><span class="p">,</span> <span class="mf">0.10822697233439012</span><span class="p">,</span> <span class="mf">0.3510368386382138</span><span class="p">,</span> <span class="mf">0.28866548953140464</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.05650583957087169</span><span class="p">,</span> <span class="mf">0.03153085438627896</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07952512989706996</span><span class="p">,</span> <span class="mf">0.36179683554733366</span><span class="p">,</span> <span class="mf">0.1558792745453362</span><span class="p">,</span> <span class="mf">0.12201450378231803</span><span class="p">,</span> <span class="mf">0.003199518521492076</span><span class="p">,</span> <span class="mf">0.03253298726923804</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1392173001874409</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.23400782002191511</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3607436556297695</span><span class="p">,</span> <span class="mf">0.222997865774028</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09896245359439204</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35357616901515954</span><span class="p">,</span> <span class="mf">0.25953541437515015</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17668446070975405</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.8885418867273566</span><span class="p">,</span> <span class="mf">0.001327460394526184</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26787504407832513</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34546981672553595</span><span class="p">,</span> <span class="mf">0.4970075829476536</span><span class="p">,</span> <span class="mf">0.25228687598351107</span><span class="p">,</span> <span class="mf">0.18535316299631793</span><span class="p">,</span> <span class="mf">0.6900024446230255</span><span class="p">,</span> <span class="mf">0.22909186354008929</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5929006071611729</span><span class="p">,</span> <span class="mf">0.3185735373272068</span><span class="p">,</span> <span class="mf">0.11761713945502322</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26575517384022385</span><span class="p">,</span> <span class="mf">0.1464566184642636</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04165502554664985</span><span class="p">,</span> <span class="mf">0.3398173573707204</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.7226023405806071</span><span class="p">,</span> <span class="mf">0.1300425269037079</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9121063910325242</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5934683678485366</span><span class="p">,</span> <span class="mf">0.06638493665119428</span><span class="p">,</span> <span class="mf">0.1423103230868066</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4525514916823224</span><span class="p">,</span> <span class="mf">0.31498793553593</span><span class="p">,</span> <span class="mf">0.5514384433510405</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5700652564109139</span><span class="p">,</span> <span class="mf">0.647001823324452</span><span class="p">,</span> <span class="mf">0.3632049164080918</span><span class="p">,</span> <span class="mf">0.29792156221101773</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5107487413816312</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5184178168250595</span><span class="p">,</span> <span class="mf">0.35747441764931004</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.44671712848797657</span><span class="p">,</span> <span class="mf">0.07193460095476585</span><span class="p">,</span> <span class="mf">0.24446175691468855</span><span class="p">,</span> <span class="mf">0.3363475040109809</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2558031952091493</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05762937090988027</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.44356040676174774</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3650527896338257</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5999828844526301</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10733829981201555</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2509396840066568</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.039869144866636765</span><span class="p">,</span> <span class="mf">0.21916939290216533</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.24298354245026962</span><span class="p">,</span> <span class="mf">0.35657134082456393</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8901912818685964</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.022738673528511125</span><span class="p">,</span> <span class="mf">0.27897282322910705</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04488614894444226</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01760735046486867</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2916819193075569</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26762878122196415</span><span class="p">,</span> <span class="mf">0.8259948988156169</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2770771342236844</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.21636295617449808</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08782523280371353</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2566676260311571</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08409555236998674</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.11031856346177855</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.299711637242986</span><span class="p">,</span> <span class="mf">0.062187990267165656</span><span class="p">,</span> <span class="mf">0.5366284432058411</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.17029014523834496</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09674642531312941</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5471915771838345</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.518409539721132</span><span class="p">,</span> <span class="mf">0.45959238322166546</span><span class="p">,</span> <span class="mf">0.20573255197486903</span><span class="p">,</span> <span class="mf">0.41021907843174243</span><span class="p">,</span> <span class="mf">0.5180459396059507</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.21009871872403965</span><span class="p">,</span> <span class="mf">0.27367689893488734</span><span class="p">,</span> <span class="mf">0.5335390378970684</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25575339071497866</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.13325289963421805</span><span class="p">,</span> <span class="mf">0.24427537876119212</span><span class="p">,</span> <span class="mf">0.21094959876511082</span><span class="p">,</span> <span class="mf">0.16944071686432932</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.5608898219862919</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.33144031811250585</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.44386023552552223</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2995024538185788</span><span class="p">,</span> <span class="mf">0.25473739212034885</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.026747238923908363</span><span class="p">,</span> <span class="mf">0.1313402525265284</span><span class="p">,</span> <span class="mf">0.32688331634822043</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2138430175504173</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2312906537509162</span><span class="p">,</span> <span class="mf">0.17598152715437446</span><span class="p">,</span> <span class="mf">0.33911655108944716</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.31877297964246265</span><span class="p">,</span> <span class="mf">0.20973601832811398</span><span class="p">,</span> <span class="mf">0.04493023841710308</span><span class="p">,</span> <span class="mf">0.47279958926039894</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.5947674316338799</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3646559616946315</span><span class="p">,</span> <span class="mf">0.22042680635361558</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34365091603277254</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.11083434241788549</span><span class="p">,</span> <span class="mf">0.39319480185064787</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.049140895652295326</span><span class="p">,</span> <span class="mf">0.35224754986401596</span><span class="p">,</span> <span class="mf">0.10602824327772471</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.36136580610930474</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15149804394046582</span><span class="p">,</span> <span class="mf">0.5853236341760505</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2330247393249639</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05212960042336549</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2493753019947928</span><span class="p">,</span> <span class="mf">0.3754215218870083</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.35676455782106054</span><span class="p">,</span> <span class="mf">0.31353635978557115</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5121744075485136</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34156440031805</span><span class="p">,</span> <span class="mf">0.5396917430490541</span><span class="p">,</span> <span class="mf">0.18668672120207783</span><span class="p">,</span> <span class="mf">0.38085462903983186</span><span class="p">,</span> <span class="mf">0.43962562207097655</span><span class="p">,</span> <span class="mf">0.6101360083106929</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.24458750088228043</span><span class="p">,</span> <span class="mf">0.4345810915322202</span><span class="p">,</span> <span class="mf">0.1304419895170894</span><span class="p">,</span> <span class="mf">0.3655203142653417</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17947344061851808</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5167718371808433</span><span class="p">,</span> <span class="mf">0.6336747672583105</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.5951036798668391</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3200751498881675</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.30023281957976755</span><span class="p">,</span> <span class="mf">0.22251319432646266</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.33168843916448376</span><span class="p">,</span> <span class="mf">0.35021316171837386</span><span class="p">,</span> <span class="mf">0.38056033994776073</span><span class="p">,</span> <span class="mf">0.1956862596245976</span><span class="p">,</span> <span class="mf">0.029511313409638192</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.36104823084850074</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.19785646615113764</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3210770877443572</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.259833187026932</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.008180969795341903</span><span class="p">,</span> <span class="mf">0.041921731629268745</span><span class="p">,</span> <span class="mf">0.008660364778113907</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.517735941702895</span><span class="p">,</span> <span class="mf">0.857592995559161</span><span class="p">,</span> <span class="mf">0.32591607364772535</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.24039780434085245</span><span class="p">,</span> <span class="mf">0.025391663463268026</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1799827163787837</span><span class="p">,</span> <span class="mf">2.295260190081591</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1402867986675579</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17284930792390737</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.37596601010477054</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10937208013455932</span><span class="p">,</span> <span class="mf">0.8138959493205707</span><span class="p">,</span> <span class="mf">0.011815365368139315</span><span class="p">,</span> <span class="mf">0.47054976181912955</span><span class="p">,</span> <span class="mf">0.04145804332504425</span><span class="p">,</span> <span class="mf">0.9514503790086146</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.05625799671142728</span><span class="p">,</span> <span class="mf">0.4931456999601273</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.20739411312393297</span><span class="p">,</span> <span class="mf">0.3961685711325033</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35748588542845117</span><span class="p">,</span> <span class="mf">0.33743004446200364</span><span class="p">,</span> <span class="mf">0.2154331616428584</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2859370541890416</span><span class="p">,</span> <span class="mf">0.1520175960638835</span><span class="p">,</span> <span class="mf">0.49447802507088684</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.33938185690025374</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.386530692935652</span><span class="p">,</span> <span class="mf">0.23277654269477238</span><span class="p">,</span> <span class="mf">0.4369887952185995</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29370244489599817</span><span class="p">,</span> <span class="mf">0.3810600413958437</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.2122136531376884</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.521280808051434</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.23434035217123653</span><span class="p">,</span> <span class="mf">0.3089933239762192</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2798417931219857</span><span class="p">,</span> <span class="mf">0.47436093089469145</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.020897409829692883</span><span class="p">,</span> <span class="mf">0.42394050447549253</span><span class="p">,</span> <span class="mf">0.27078361216362673</span><span class="p">,</span> <span class="mf">0.087578089533156</span><span class="p">,</span> <span class="mf">0.26293069222494136</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.20901797787019646</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17873224199963714</span><span class="p">,</span> <span class="mf">0.4534117138117518</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2790851120445561</span><span class="p">,</span> <span class="mf">0.39986781320801096</span><span class="p">],</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        
        <span class="n">w3</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.20469325596820687</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34115257543583677</span><span class="p">,</span> <span class="mf">0.19728763175730454</span><span class="p">,</span> <span class="mf">0.2063227740634609</span><span class="p">,</span> <span class="mf">0.26773686369505223</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7620165039161816</span><span class="p">,</span> <span class="mf">0.28886161355374906</span><span class="p">,</span> <span class="mf">0.4639857562556888</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35162280785200667</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.321144798222583</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.442719130872063</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4545268173759951</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5967498343146402</span><span class="p">,</span> <span class="mf">0.9262972364700224</span><span class="p">,</span> <span class="mf">0.5874340560892706</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5937066592454496</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.20946972651791432</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3746953074291135</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5775919167836157</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1287699134905062</span><span class="p">,</span> <span class="mf">0.7070379766590361</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.11248845371901833</span><span class="p">,</span> <span class="mf">0.5481818017059644</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5709465078343058</span><span class="p">,</span> <span class="mf">0.5227467274541583</span><span class="p">,</span> <span class="mf">0.622767210502863</span><span class="p">,</span> <span class="mf">0.18263193635644256</span><span class="p">,</span> <span class="mf">0.8738176370255476</span><span class="p">,</span> <span class="mf">0.6373937276993936</span><span class="p">,</span> <span class="mf">0.06939171136743856</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17971755236635154</span><span class="p">,</span> <span class="mf">0.03370083344948084</span><span class="p">],</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

        <span class="n">b</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="o">-</span><span class="mf">0.10388973620646459</span><span class="p">,</span> <span class="mf">0.28569364904241784</span><span class="p">,</span> <span class="mf">0.14218029836430307</span><span class="p">,</span> <span class="mf">0.2358534653299724</span><span class="p">,</span> <span class="mf">0.13215845583055655</span><span class="p">,</span> <span class="mf">0.13202588947896907</span><span class="p">,</span> <span class="mf">0.21907165887779737</span><span class="p">,</span> <span class="mf">0.2686640601861153</span><span class="p">,</span>
            <span class="mf">0.1144287254972733</span><span class="p">,</span> <span class="mf">0.2578297565037551</span><span class="p">,</span> <span class="mf">0.02891001147862591</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12100540073040143</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09763531217743227</span><span class="p">,</span> <span class="mf">0.05773908364022649</span><span class="p">,</span> <span class="mf">0.06674230971111526</span><span class="p">,</span> <span class="mf">0.09717028497781278</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

        <span class="n">b1</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="mf">0.022476759818808884</span><span class="p">,</span> <span class="mf">0.06522787447191643</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.014704387279203337</span><span class="p">,</span> <span class="mf">0.1096374663689587</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05440171127270248</span><span class="p">,</span> <span class="mf">0.09028210024793715</span><span class="p">,</span> <span class="mf">0.32331745875105944</span><span class="p">,</span> <span class="mf">0.057105461894815614</span><span class="p">,</span>
            <span class="mf">0.057290296437207955</span><span class="p">,</span> <span class="mf">0.16575651814670797</span><span class="p">,</span> <span class="mf">0.028858095485021478</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.23377543412696206</span><span class="p">,</span> <span class="mf">0.004647878425389973</span><span class="p">,</span> <span class="mf">0.059561098550835405</span><span class="p">,</span> <span class="mf">0.1043107038091163</span><span class="p">,</span> <span class="mf">0.17370218033430374</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

        <span class="n">b2</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="mf">0.004819399003695486</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.024907489079537354</span><span class="p">,</span> <span class="mf">0.06724733986081394</span><span class="p">,</span> <span class="mf">0.01979302017757484</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04114135845688159</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.011615947262669913</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.024769012012465872</span><span class="p">,</span> <span class="mf">0.07458398675892401</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">0.01389492808996807</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.017278122108917517</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.010393727683392022</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0022579707865170583</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.020020447735082682</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25852216119792715</span><span class="p">,</span> <span class="mf">0.09445572505091969</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.029852434851929288</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

        <span class="n">b3</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="mf">0.03510259928999757</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03510259928999723</span>
            <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;linear&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;w&#39;</span><span class="p">:</span> <span class="n">w</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">b</span><span class="p">,},</span>
            <span class="s1">&#39;linear_1&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;w&#39;</span><span class="p">:</span> <span class="n">w1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">b1</span><span class="p">,},</span>
            <span class="s1">&#39;linear_2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;w&#39;</span><span class="p">:</span> <span class="n">w2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">b2</span><span class="p">,},</span>
            <span class="s1">&#39;linear_3&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;w&#39;</span><span class="p">:</span> <span class="n">w3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">b3</span><span class="p">,},</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">data_structures</span><span class="o">.</span><span class="n">to_immutable_dict</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
        <span class="k">def</span> <span class="nf">net_fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">mlp</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
                <span class="n">hk</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">swish</span><span class="p">,</span>
                <span class="n">hk</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">swish</span><span class="p">,</span>
                <span class="n">hk</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">swish</span><span class="p">,</span>
                <span class="n">hk</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">,</span>
            <span class="p">])</span>
            <span class="k">return</span> <span class="n">mlp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">without_apply_rng</span><span class="p">(</span><span class="n">hk</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">net_fn</span><span class="p">))</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Chair of Aerodynamics and Fluid Mechanics, Technical University of Munich.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>